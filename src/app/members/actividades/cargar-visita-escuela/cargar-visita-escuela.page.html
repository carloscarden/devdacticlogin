<ion-header>
  <ion-toolbar>
    <ion-title>CARGA VISITA ESCUELA</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content padding>
    <form #visitaForm="ngForm"  (ngSubmit)="logForm()">

        <ion-item>
            <ion-label>FECHA</ion-label>
                <ion-datetime displayFormat="MM DD YY" placeholder="Select Date" [(ngModel)]="inspeccion.inicio" name="fechaInicio" #fechaInicio="ngModel" required></ion-datetime>
                <div *ngIf="!(fechaInicio.valid || fechaInicio.pristine)" class="invalid-feedback">
                     La fecha de inicio es requerida
                </div>
        </ion-item>

        <ion-item>
          <ion-label>HORA INICIO</ion-label>
          <ion-datetime displayFormat="HH:mm" placeholder="Select Hora Inicio" [(ngModel)]="inspeccion.horaInicio" name="horaInicio" #horaInicio="ngModel" required></ion-datetime>
          <div *ngIf="!(horaInicio.valid || horaInicio.pristine)" class="invalid-feedback">
              La fecha de inicio es requerida
         </div>
        </ion-item>
        
        <ion-item>
          <ion-label>HORA FIN</ion-label>
          <ion-datetime displayFormat="HH:mm" placeholder="Select Hora Fin" [(ngModel)]="inspeccion.horaFin" name="horaFin" #horaFin="ngModel" required></ion-datetime>
          <div *ngIf="!(horaFin.valid || horaFin.pristine)" class="invalid-feedback">
              La fecha de inicio es requerida
         </div>
        </ion-item>

        <ion-item>
            <ion-label>SERVICIO VISITADO</ion-label>
            <ionic-selectable
              item-content
              [(ngModel)]="establecimiento"
              itemValueField="id"
              itemTextField="tipo"
              [items]="establecimientos"
              [canSearch]="true"
              (onSearch)="searchEstab($event)">
            </ionic-selectable>
          </ion-item>

          <ion-item>
              <ion-label>MOTIVO</ion-label>
              <ionic-selectable
                item-content
                [(ngModel)]="motivo"
                itemValueField="id"
                itemTextField="tipo"
                [items]="motivos"
                [canSearch]="true"
                (onSearch)="searchMotivos($event)">
              </ionic-selectable>
          </ion-item>

        <ion-item>
           <ion-label>SERVICIO VISITADO</ion-label>
           <ion-select value="brown" okText="Okay" cancelText="Dismiss">
              <ion-select-option value="brown">Brown</ion-select-option>
              <ion-select-option value="blonde">Blonde</ion-select-option>
              <ion-select-option value="black">Black</ion-select-option>
              <ion-select-option value="red">Red</ion-select-option>
           </ion-select>
         </ion-item>

        <ion-item>
            <ion-label>MOTIVO</ion-label>
            <ion-select value="brown" okText="Okay" cancelText="Dismiss">
              <ion-select-option value="brown">Brown</ion-select-option>
              <ion-select-option value="blonde">Blonde</ion-select-option>
              <ion-select-option value="black">Black</ion-select-option>
              <ion-select-option value="red">Red</ion-select-option>
            </ion-select>
        </ion-item>

        <ion-item>
          <ion-label>OBSERVACIONES</ion-label>
          <ion-input type="text" [(ngModel)]="inspeccion.observaciones" name="observaciones" #observaciones="ngModel" required></ion-input>
        </ion-item>

        <ion-item>
            <ion-label>INSPECTOR VISITANTE</ion-label>
            <ion-input type="text" [(ngModel)]="inspeccion.inspectorVisitante" name="observaciones" #observaciones="ngModel" required></ion-input>
        </ion-item>
        

        
        


        <ion-item>
           <h4 *ngIf="images.length == 0" text-center>SELECCIONE IMAGENES!</h4>
           <ion-list>
               <ion-item *ngFor="let img of images; index as pos" text-wrap>
                  <ion-thumbnail slot="start">
                    <ion-img [src]="img.path"></ion-img>
                  </ion-thumbnail>
                  <ion-label>
                     {{ img.name }}
                  </ion-label>
                  <ion-button slot="end" fill="clear" (click)="startUpload(img)">
                    <ion-icon slot="icon-only" name="cloud-upload"></ion-icon>
                  </ion-button>
                  <ion-button slot="end" fill="clear" (click)="deleteImage(img, pos)">
                    <ion-icon slot="icon-only" name="trash"></ion-icon>
                  </ion-button>
               </ion-item>
          </ion-list>
        </ion-item>

        
         <ion-item>
           <ion-button fill="clear" expand="full"  (click)="selectImage()">
              <ion-icon slot="start" name="camera"></ion-icon> Select Image
           </ion-button>
         </ion-item>

       
         <ion-fab vertical="bottom" horizontal="end" slot="fixed">
             <ion-fab-button type="submit" [disabled]="!visitaForm.form.valid">
                <ion-button type="submit" [disabled]="!visitaForm.form.valid">
                      <ion-icon name="checkmark-circle-outline"></ion-icon>
                </ion-button>
             </ion-fab-button>
          </ion-fab>
      </form>
      <button (click)="goBack()">go back</button>

</ion-content>
